---
title: 核心概念：用搭积木的方式理解 ComfyUI
description: 把节点、工作流、模型加载、LoRA、VAE 看成可拼接的功能积木，建立清晰的心智模型。
order: 1
heroImage: /assets/uploads/1.svg
keywords:
  - 节点
  - 工作流
  - 模型管理
  - LoRA
  - VAE
goal: 10 分钟梳理 ComfyUI 的核心协作关系
duration: 10 分钟
difficulty: 入门
prerequisites:
  - 已成功启动 ComfyUI
  - 知道如何新增并连接节点
deliverables:
  - 看懂常见节点的输入输出类型
  - 能够快速判断一条工作流的结构
pitfalls:
  - 只记节点名称，不清楚传递的数据类型
  - 忽视 VAE 导致输出图像灰度异常
  - 将 LoRA 误当成模型替换而不是叠加
ctaButtons: []
---
import AnnotatedImage from "../../components/mdx/AnnotatedImage.astro";
import TipCard from "../../components/mdx/TipCard.astro";

## 节点导言

ComfyUI 是一个纯节点式的图像生成工具。每个节点负责一个独立的“功能积木”，例如加载模型、准备提示词或保存结果。理解这些节点之间的协作关系，是搭建任何工作流前必须补齐的地基。

<AnnotatedImage
  src="/assets/uploads/2.svg"
  alt="ComfyUI 基础节点协作示意"
  caption="同一条连线中同时存在数据、权重与执行节点"
/>

在接下来的章节里，我们会反复使用这张思维导图，帮助你快速定位“当前节点属于哪类语义”。当你知道下一步要寻找的节点类型时，构建和调试工作流都会事半功倍。

## 工作流示例

下图展示了一条最小化的文生图工作流。从提示词编码、噪声采样，到 VAE 解码与保存成品，所有节点都遵循“左侧输入、右侧输出”的流程。

![核心工作流节点示意](/assets/uploads/wechat_2025-10-04_193054_297.png)

<TipCard title="端口类型必须一一对应" tone="info">
  <p>ComfyUI 不会阻止你胡乱连线，但执行时一定会报错。端口上写着 <code>MODEL</code>、<code>CONDITIONING</code>、<code>LATENT</code> 等标签，表示允许传递的数据类型。若把 <code>IMAGE</code> 接到 <code>MODEL</code>，采样器将无法读取正确参数。</p>
</TipCard>

## 三大节点家族

1. <strong>控制与权重节点</strong>：包含 Checkpoint Loader、LoRA Loader、VAE Loader 等。这些节点提供“用什么模型”的信息，通常输出 <code>MODEL</code>、<code>CLIP</code>、<code>VAE</code> 信号。
2. <strong>数据与特征节点</strong>：例如 <code>CLIP Text Encode</code> 输出文字特征，<code>Empty Latent Image</code> 创建潜空间画布，<code>Latent Upscale</code> 用于扩图。它们负责传递真实数据。
3. <strong>执行节点</strong>：例如 <code>KSampler</code>、<code>Save Image</code>、<code>Queue Prompt</code>。这些节点会触发实际的计算和写入磁盘。

![节点分类示例](/assets/uploads/wechat_2025-10-04_193507_757.png)

掌握分类方法后，你可以快速判断“当前节点缺失的究竟是数据还是权重”。这正是排查工作流错误的第一步。

## 典型数据流拆解

1. <strong>提示词注入</strong>：正/反向提示词通过 <code>CLIP Text Encode</code> 转成向量，再分别接入 <code>KSampler</code> 的正向与负向输入。
2. <strong>潜空间生成</strong>：<code>Empty Latent Image</code> 决定输出分辨率，<code>KSampler</code> 迭代去噪，得到最终的潜空间结果。
3. <strong>解码与输出</strong>：潜空间送入 <code>VAE Decode</code>，再传给 <code>Save Image</code> 或 <code>Preview Image</code>。

![数据流示意](/assets/uploads/wechat_2025-10-04_193214_647.png)

<TipCard title="采样器的关键参数" tone="warning">
  <ul>
    <li><strong>Steps</strong>：迭代次数，越高细节越多，但耗时越长。</li>
    <li><strong>CFG Scale</strong>：遵循提示词的力度，过高会出现过度锐化。</li>
    <li><strong>Sampler / Scheduler</strong>：决定降噪曲线，常见组合有 <code>Euler + Simple</code>、<code>DPM++ 2M + Karras</code>。</li>
  </ul>
</TipCard>

## 常见错误速记

- 忘记闭合采样环路：<code>KSampler</code> 需要 <code>MODEL</code>、正向/负向 <code>CONDITIONING</code> 以及 <code>LATENT</code> 四条输入。
- 未经过 VAE 解码就保存：直接保存潜空间会得到噪点图像，请务必经过 <code>VAE Decode</code>。
- 随意叠加 LoRA：同一基座模型才能共享 LoRA，叠加多个不同基座的 LoRA 会导致风格混乱。

理解这些基础概念后，你就能在看到陌生工作流时迅速判断“它在做什么、我该替换哪部分”。接下来第二章会带你完成一条可复用的文生图工作流。
